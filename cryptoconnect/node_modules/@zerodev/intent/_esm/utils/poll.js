// Note: This is a copied version of the poll function from viem. : https://github.com/wevm/viem/blob/aca3e1d75d979aa50f5737a2fabaf0088b160f46/src/utils/poll.ts
export async function wait(time) {
    return new Promise((res) => setTimeout(res, time));
}
/**
 * @description Polls a function at a specified interval.
 */
export function poll(
// biome-ignore lint/suspicious/noConfusingVoidType: <explanation>
fn, { emitOnBegin, initialWaitTime, interval }) {
    let active = true;
    // biome-ignore lint/suspicious/noAssignInExpressions: <explanation>
    const unwatch = () => (active = false);
    const watch = async () => {
        // biome-ignore lint/suspicious/noConfusingVoidType: <explanation>
        let data = undefined;
        if (emitOnBegin)
            data = await fn({ unpoll: unwatch });
        const initialWait = (await initialWaitTime?.(data)) ?? interval;
        await wait(initialWait);
        const poll = async () => {
            if (!active)
                return;
            await fn({ unpoll: unwatch });
            await wait(interval);
            poll();
        };
        poll();
    };
    watch();
    return unwatch;
}
//# sourceMappingURL=poll.js.map